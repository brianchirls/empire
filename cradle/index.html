<html>
<head>
<meta http-equiv="Contexnt Type" content="text/html; charset=iso-8899-1" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" />
	<title>Cradle flip version</title>
</head>
<body>

	<div class="outer">
		<div id="header" style="padding-top: 23px;">
			<a href="videos.html"><img src="art/logo.jpg" width="179" height="33"></a><br />
			<a href="videos.html"><img src="art/Bakermat.png" width="81" height="22"></a>
		</div>
		<div id="outerinner">
			<div id="instructions1" style="display: none;">
			</div>
			<div id="container">
				<div id="leftbutton" class="flipbuttons buttonoff"></div>
				<div id="rightbutton" class="flipbuttons buttonon"></div>
				<div id="cardover"></div>
				<div id="card">
					<div class="front">
						<video id="video1" src="mp4/schipol.mp4" autoplay="off" width="960" height="540"></video>
					</div>
					<div class="back">
						<video id="video2" src="mp4/spotters.mp4" autoplay="off" width="960" height="540"></video>
					</div>
				</div>
			</div>
			<div id="controls">
				<span id="playElement" style="cursor: pointer;"></span>
				<div id="scrubber"><div id="progress"></div>
			</div>
		</div>
					
		<div id="menu">
			<div id="videos" onclick="location.href='videos.html'"></div>
			<div id="essays" onclick="location.href='essays.html'"></div>
			<div id="about" onclick="location.href='about.html'"></div>
			</div>
		
	</div>
			
    <script>

		var x = 0;
		var y = 0;

		var xMargin = 10;
		var yMargin = 480;
		var imgWidth = 960;
		var imgHeight = 540;


		var vid1Loaded = false;
		var vid2Loaded = false;
		var playState = 0;
		var instructionsin = false;
		var flipside = false;
		var flipangle = 0;

		$(document).ready(function(){		
			$("#leftbutton").click(function () {
				flipper(false);
			});
			$("#rightbutton").click(function () {
				flipper(true);
			});
		
			document.getElementById("video1").addEventListener("canplay",function(){vid1Loaded = true; playDecide();},true);
			document.getElementById("video2").addEventListener("canplay",function(){vid2Loaded = true; playDecide();},true);
			
			document.getElementById("video1").addEventListener("ended",function(){ endVids();},true);
			document.getElementById("video1").addEventListener("timeupdate",function(){scrubberUpdater();},true);
			
			$("#cardover").mouseover(function () {
				trackon();
			});

			$("#cardover").mouseout(function () {
				trackoff();
			});
			
		});
		
					console.log($("#card").css('transform'));

		function trackon () {
			$(document).mousemove(function(e){
				var x = e.pageX - $("#cardover").offset().left;
				if(flipside){
					if(x < 480){
						if(x < 180){
							 flipper(false);
						} else {
							deg = Math.floor(((x - 150) / 3));
							flipangle = deg;
							$("#card").css({ 'transform': 'rotateY( ' + deg + 'deg )', '-webkit-transform': 'rotateY( ' + deg + 'deg )' });
						}
					}
				} else {
					if(x > 480){
						if(x > 780){
							flipper(true);
						} else {
							deg = Math.floor(((x - 480) / 3));
							flipangle = deg;
							$("#card").css({ 'transform': 'rotateY( ' + deg + 'deg )', '-webkit-transform': 'rotateY( ' + deg + 'deg )' });
						}
					}
				}
				
				});
		}
		
		function trackoff () {
			$(document).unbind('mousemove');
		}
		
		function flipper (isright){
			if(flipside){
				if(!isright){
					fullflip(0);
					flipside = false;
					flipangle = 0;
					$("#leftbutton").removeClass('buttonon').addClass('buttonoff');
					$("#rightbutton").removeClass('buttonoff').addClass('buttonon');
				}
			} else {
				if(isright){
					fullflip(180);
					flipside = true;
					flipangle = 180;
					$("#rightbutton").removeClass('buttonon').addClass('buttonoff');
					$("#leftbutton").removeClass('buttonoff').addClass('buttonon');
				}
			}
		}
		
		function fullflip (deg) {
			$("#card").css({ 'transform': 'rotateY( ' + deg + 'deg )', '-webkit-transform': 'rotateY( ' + deg + 'deg )' });
		}
		
		function scrubberUpdater (intime){
			var dur = Math.floor(document.getElementById("video1").currentTime);
			if(dur > 0){
				var ratio = (document.getElementById("video1").duration / dur);
			}
			$("#progress").css({ "width": (930 / ratio) + 'px' })
		}
		
		function playDecide(){
			if(vid1Loaded && vid2Loaded){
				playVids();
				playState = 1;
			}
		}
		
		$("#playElement").click(function () {
			playButton();
			if(playState == 1){
				$("#playElement").css({'background':'url(art/playGray.png)'})
			} else {				
				$("#playElement").css({'background':'url(art/pauseGray.png)'})
			}
		}).mouseover(function (){
			if(playState == 1){
				$("#playElement").css({'background':'url(art/playWhite.png)'})
			} else {				
				$("#playElement").css({'background':'url(art/pauseWhite.png)'})
			}
		}).mouseout(function (){
				if(playState == 1){
					$("#playElement").css({'background':'url(art/playGray.png)'})
				} else {				
					$("#playElement").css({'background':'url(art/pauseGray.png)'})
				}
		});
		
		function playButton(){
			if(playState == 1){
				pauseVids();
			}
			else if(playState == 2){
				playVids();
				playState = 1;
			}
			else{
				document.getElementById("video1").currentTime = 0;
				document.getElementById("video2").currentTime = 0;
				playVids();
				playState = 1;				
			}
		}
		
		function playVids(){
			document.getElementById("video1").play();
			document.getElementById("video2").play();
		}
		
		function pauseVids(){
			document.getElementById("video1").pause();
			document.getElementById("video2").pause();
			playState = 2;
		}
		
		function endVids(){
//			$("#instructions1").fadeIn('slow');
			playState = 3;
			pauseMouse();
		}

    </script>	

</body>
</html>